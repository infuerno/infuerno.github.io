<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Using CSLA 4 06 ASP.NET MVC</title>
		<meta name="description" content="There are 18 different shades of British Standard Toast">
		<meta name="generator" content="Eleventy v3.1.2">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter,
		DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-10: #f7f7f7;
	--color-gray-15: #f0f0f0;
	--color-gray-20: #e0e0e0;
	--color-gray-30: #d0d0d0;
	--color-gray-40: #dedede;
	--color-gray-50: #c0c0c0;
	--color-gray-60: #b0b0b0;
	--color-gray-70: #a0a0a0;
	--color-gray-90: #333;

	--background-color: #fff;
	--text-color: var(--color-gray-90);

	--text-color-link-header: #082840;
	--text-color-link-active-header: #5f2b48;
	--text-color-link-visited-header: #17050f;
	--text-color-link: #27c0df;
	--text-color-link-visited: #27c0df;
	--text-color-link-active: #21daff;

	--text-color-link: #08cb00;
	--text-color-link-visited: #253900;
	--text-color-link-active: #09ff00;
	--text-color-code: #efe;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #c0c0c0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}

/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
	line-height: 1.5;
}
html {
	overflow-y: scroll;
}
body {
	max-width: 50em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img {
	max-width: 100%;
}
img[width][height] {
	height: auto;
}
img[src$=".svg"] {
	width: 100%;
	height: auto;
	max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
/* added to body instead */
/* p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
} */

header a[href] {
	color: var(--text-color-link-header);
}
header a[href]:visited {
	color: var(--text-color-link-visited-header);
}
header a[href]:hover,
header a[href]:active {
	color: var(--text-color-link-active-header);
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
main :first-child {
	margin-top: 0;
}

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: 0.5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
}
:not(pre) > code {
	border: 1px solid #e8e8e8;
	border-radius: 3px;
	background-color: #eef;
	background-color: #cceeff;
	background-color: var(--text-color-code);
}
pre:not([class*="language-"]) {
	margin: 0.5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
	background-color: #eef;
	background-color: #cceeff;
	background-color: var(--text-color-code);
	padding: 1em;
	border-radius: 0.3em;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1.2em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: 0.5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
	padding-left: 1.5rem;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	content: "" counter(start-from, decimal-leading-zero) ". ";
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
	padding-left: 5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	padding-left: 0.25em;
	padding-right: 0.5em;
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	text-transform: capitalize;
	font-style: italic;
}
.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: 0.5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	border-left: 4px solid var(--color-gray-20);
	margin-left: 0;
	margin-right: 0;
	padding-left: 1em;
	color: var(--color-gray-70);
	letter-spacing: -1px;
	font-style: italic;
	font-size: 1.05em;
}

table {
	margin-bottom: 30px;
	width: 100%;
	text-align: left;
	color: var(--color-gray-90);
	border-collapse: collapse;
	/*border: 1px solid #e8e8e8;*/
}

table tr:nth-child(even) {
	background-color: var(--color-gray-10);
}

table th,
table td {
	padding: 10px 15px;
}

table th {
	background-color: var(--color-gray-15);
	border: 1px solid var(--color-gray-40);
	border-bottom-color: var(--color-gray-60);
}

table td {
	border: 1px solid var(--color-gray-20);
}
/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}</style>
		
	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/infuerno.github.io/" class="home-link">infuerno.github.io</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/infuerno.github.io/">Home</a></li>
					<li class="nav-item"><a href="/infuerno.github.io/about/">About</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="using-csla-4-06-asp-net-mvc">Using CSLA 4 06 ASP.NET MVC</h1>

<ul class="post-metadata">
	<li><time datetime="2018-07-09">09 July 2018</time></li>
</ul>

<h3 id="references">References</h3>
<ul>
<li><a href="https://www.red-gate.com/simple-talk/dotnet/asp-net/advanced-uses-razor-views-asp-net-mvc/">https://www.red-gate.com/simple-talk/dotnet/asp-net/advanced-uses-razor-views-asp-net-mvc/</a></li>
</ul>
<h2 id="chapter-1-asp-net-mvc">Chapter 1: <a href="http://ASP.NET">ASP.NET</a> MVC</h2>
<h3 id="asp-net-mvc-introduction"><a href="http://ASP.NET">ASP.NET</a> MVC Introduction</h3>
<h4 id="mvc-design-pattern">MVC Design Pattern</h4>
<p>Model, View, Controller map directly to 3 of the 5 <a href="http://CSLA.NET">CSLA.NET</a> layers:</p>
<ul>
<li>Model &gt; Business Logic</li>
<li>Controller &gt; Interface Control</li>
<li>View &gt; Interface</li>
</ul>
<p>ViewModel objects are typically used in MVC since many domain objects are data centric and therefore don’t have properties appropriate for a view. This often happens when using an ORM to create domain objects. HOWEVER, in CSLA business objects should already reflect the user scenario. ViewModels should not generally be required.</p>
<h4 id="asp-net-mvc-framework"><a href="http://ASP.NET">ASP.NET</a> MVC Framework</h4>
<p>The framework supports the MVC design pattern. For CSLA MVC, all controller need to inherit from the <code>Csla.Web.Mvc.Controller</code> base class.</p>
<ul>
<li><code>ViewData</code> is a dictionary object for passing arbitrary data to the view, but also has a <code>Model</code> property for providing a reference to a model object.</li>
<li><code>ViewBag</code> is a dynamic object and as such has no compile time checking. Typos are hard to spot.</li>
</ul>
<p>The default MVC model binder works fine for objects with:</p>
<ul>
<li>a default constructor</li>
<li>properties with getters and setters</li>
<li>data validations, but nothing more complicated</li>
</ul>
<p>For some CSLA objects the regular model binder will fail. In these circumstances the alternative CSLA model binder can be used.</p>
<h3 id="csla-net-mvc-features"><a href="http://CSLA.NET">CSLA.NET</a> MVC Features</h3>
<h4 id="asp-net-support"><a href="http://ASP.NET">ASP.NET</a> Support</h4>
<p>The <code>ApplicationContext</code> object (stored on the HttpContext in <a href="http://ASP.NET">ASP.NET</a>) contains:</p>
<ol>
<li>Access to numerous configuration settings</li>
<li>3 context dictionaries: <code>LocalContext</code>, <code>ClientContext</code>, <code>GlobalContext</code></li>
<li><code>User</code> property to access the principal</li>
</ol>
<p>A reference to <code>Csla.Web</code> must be added to ensure all features work as expected.</p>
<h4 id="asp-net-mvc-support"><a href="http://ASP.NET">ASP.NET</a> MVC Support</h4>
<p>Use of the MVC features is optional. The <code>Csla.Web.Mvc</code> assembly references the <code>System.Web.Mvc</code> assembly, so the correct version of the <code>Csla.Web.Mvc</code> assembly must be used.</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Controller</code></td>
<td>Has <code>SaveObject</code> and <code>LoadProperty</code> methods simplify having to use ‘new’ objects whether for create, edit OR delete. <code>SaveObject</code> method accepts the object to be save, a boolean indicating create or update and an optional alternative implementation of UpdateModel</td>
</tr>
<tr>
<td><code>CslaModelBinder</code></td>
<td>The regular <a href="http://ASP.NET">ASP.NET</a> model binder invokes <code>DataAnnotations</code> attribute rules after copying postdata back to an object. However CSLA has also run the same rules when each property’s <code>SetProperty</code> method is called during the model binding. The <code>CslaModelBinder</code> solves this problem by suspending rules when copying back (using <code>ICheckRules</code> interface) and then invoking all business and validation rules for the object. If using this model binder with list objects, ensure the <code>name</code> property of each HTML element follows the <a href="http://ASP.NET">ASP.NET</a> MVC list conventions i.e. the name will be rendered as <code>[0].personId</code> or <code>[0].firstName</code> (literally). <code>Html</code> helper methods will take care of this. The custom model binder must be loaded at application start i.e. in <code>Application_Start</code> of <code>Global.asax.cs</code> either globally - use <code>ModelBinders.Binders.DefaultBinder = new Csla.Web.Mvc.CslaModelBinder();</code> - or for a subset of types - <code>var cslaBinder = new Csla.Web.Mvc.CslaModelBinder(); ModelBinders.Binders.Add(typeof(ProjectTracker.Library.ProjectEdit), cslaBinder);</code>. Using the <code>CslaModelBinder</code> for all types is usual.</td>
</tr>
<tr>
<td><code>IModelCreator</code></td>
<td>To bind the form collection to an object, an instance of the object needs to be created, often using <code>new</code>. In some circumstances for CSLA, the <code>create</code> factory method should instead by used. If the controller implements <code>IModelCreator</code> the method <code>CreateModel</code> needs to be implemented to specify how the model should be created e.g. by calling the static method <code>ProjectEdit.NewProject()</code>. <code>CreateModel</code> will be called by the <code>CslaModelBinder</code>. Alternative to this is to use view models (see below).</td>
</tr>
<tr>
<td><code>HtmlExtensions</code></td>
<td>The <code>Csla.Web.Mvc</code> namespace includes a <code>Html.HasPermission</code> extension method to customise the UI. The helper method defines markup which should be rendered if the user has permission and if the user doesn’t have permission. In this way elements can be hidden or made read only as required. The <code>IAuthorizeReadWrite</code> can alternatively be used.</td>
</tr>
<tr>
<td><code>HasPermissionAttribute</code></td>
<td>Can be applied to a controller or action method. Used to leverage CSLA authorization rules for objects e.g. GetObject or CreateObject. Will redirect the user to the login screen if not authenticated or not authorised to perform this action. Generally UI elements should be hidden (e.g. using <code>Html.HasPermission</code>) but directly addressable controllers and actions must additionally be protected in this way.</td>
</tr>
<tr>
<td><code>IViewModel</code></td>
<td>Used with ViewModels which generally rely on an existing BO for most properties, but want to add extra read only properties to be displayed, or extra verbs for use by the controller. The controller implements <code>IViewModel</code>. When model binding back, the underlying business object is used.</td>
</tr>
<tr>
<td><code>ViewModelBase</code></td>
<td>Implements <code>IViewModel</code>. Optional. The ViewModel object will generally create / get the BO, rather than the controller (so the controller no longer needs to implement the interface).</td>
</tr>
</tbody>
</table>
<h4 id="mvvm">MVVM</h4>
<p>The MVVM pattern specifies that the view binds to a viewmodel object, and the viewmodel object manages the model object.</p>
<h2 id="chapter-2-business-and-data-access-layers">Chapter 2: Business and Data Access Layers</h2>
<h2 id="chapter-3-application-implementation">Chapter 3: Application Implementation</h2>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/infuerno.github.io/2018/06/25/pluralsight-polly-fault-tolerant-web-service-requests/">Pluralsight: Polly Fault Tolerant Web Service Requests</a></li><li class="links-nextprev-next">Next →<br><a href="/infuerno.github.io/2018/07/13/Install-local-version-of-ghost-for-development/">Install Local Version Of Ghost For Development</a></li>
</ul>

			</heading-anchors>
		</main>

		<footer>
			<p>
				<em>Built with <a href="https://www.11ty.dev/">Eleventy v3.1.2</a></em>
			</p>
		</footer>

		<!-- This page `/2018/07/09/using-csla4-06-aspnet-mvc/` was built on 2025-09-05T01:23:56.888Z -->
		<script type="module" src="/infuerno.github.io/dist/xbxy_EL6cU.js"></script>
	</body>
</html>
